# ─────────────────────────────────────────────────────────────
# Script: 03_slave_voyages_clean_column_names.R
# Purpose: Standardize and replace raw column names using the updated SQL schema
# Author: Edward Parlati
# Last updated: April 17, 2025
# Project: Slave Voyages Completeness Assessment
# GitHub: https://github.com/edwardparlati/slave-voyages-completeness-audit
# ─────────────────────────────────────────────────────────────
# Description:
# This script replaces the default column names from the SPSS file with descriptive, human-readable names
# based on the updated SQL schema used in the relational database. It prepares the dataset for cleaning
# and restructuring into relational tables.
#
# Key tasks:
# - Replace 274 coded column names with standardized schema-aligned names
# - Review updated names with `glimpse()` and `names()`
# - Save updated dataset as a CSV for inspection or downstream processing
#
# Output:
# - `voyages_dataset.csv`, updated with clean, schema-aligned column names
# ─────────────────────────────────────────────────────────────

### Rename column names utilizing the created SQL schema. 274 columns,36108 rows
colnames(voyages_dataset) <- c("voyage_id",
                               "adult_embark_total",
                               "adult_death_passage",
                               "adult_disembark_total",
                               "secondary_sale_location",
                               "tertiary_sale_location",
                               "adult_embark_port1",
                               "adult_died_passage",
                               "adult_disembark_port1",
                               "adult_embark_port2",
                               "adult_embark_port3",
                               "adult_disembark_port2",
                               "adult_arrival_total",
                               "primary_disembark_port",
                               "secondary_disembark_port",
                               "boy_embark_port1",
                               "boy_died_passage",
                               "boy_disembark_port1",
                               "boy_embark_port2",
                               "boy_embark_port3",
                               "boy_disembark_port2",
                               "boy_arrival_total",
                               "pct_boy_embark",
                               "pct_boy_landed",
                               "pct_boy_arrival",
                               "captain_1_name",
                               "captain_2_name",
                               "captain_3_name",
                               "child_embark_total",
                               "child_death_passage",
                               "child_disembark_total",
                               "child_embark_port1",
                               "child_died_passage",
                               "child_disembark_port1",
                               "child_embark_port2",
                               "child_embark_port3",
                               "child_disembark_port2",
                               "child_arrival_total",
                               "pct_child_embark",
                               "pct_child_landed",
                               "pct_child_arrival",
                               "construction_region",
                               "crew_unspecified",
                               "crew_initial",
                               "crew_after_purchase",
                               "crew_first_landing",
                               "crew_return_start",
                               "crew_final",
                               "crew_died_total",
                               "slave_purchase_start_day",
                               "slave_purchase_start_month",
                               "slave_purchase_start_year",
                               "primary_landing_day",
                               "primary_landing_month",
                               "primary_landing_year",
                               "secondary_landing_day",
                               "secondary_landing_month",
                               "secondary_landing_year",
                               "tertiary_landing_day",
                               "tertiary_landing_month",
                               "tertiary_landing_year",
                               "voyage_end_day",
                               "voyage_end_month",
                               "voyage_end_year",
                               "slave_purchase_date",
                               "voyage_start_date",
                               "voyage_start_day",
                               "return_departure_date",
                               "voyage_start_month",
                               "voyage_start_year",
                               "voyage_end_date",
                               "primary_landing_date",
                               "secondary_landing_date",
                               "tertiary_landing_date",
                               "departure_from_africa_date",
                               "return_departure_day",
                               "return_departure_month",
                               "return_departure_year",
                               "departure_region",
                               "departure_broad_region",
                               "departure_from_africa_day",
                               "departure_from_africa_month",
                               "departure_from_africa_year",
                               "primary_embark_port",
                               "secondary_embark_port",
                               "primary_embark_region",
                               "secondary_embark_region",
                               "evergreen",
                               "voyage_outcome_code",
                               "slave_outcome_code",
                               "capture_outcome_code",
                               "owner_outcome_code",
                               "female_embark_port1",
                               "female_died_passage",
                               "female_disembark_port1",
                               "female_embark_port2",
                               "female_embark_port3",
                               "female_disembark_port2",
                               "female_arrival_total",
                               "female_embark_total",
                               "female_death_passage",
                               "female_disembark_total",
                               "girl_embark_port1",
                               "girl_died_passage",
                               "girl_disembark_port1",
                               "girl_embark_port2",
                               "girl_embark_port3",
                               "girl_disembark_port2",
                               "girl_arrival_total",
                               "pct_girl_embark",
                               "pct_girl_landed",
                               "pct_girl_arrival",
                               "gun_count",
                               "infant_embark_port1",
                               "infant_died_passage",
                               "infant_disembark_port1",
                               "infant_embark_port2",
                               "infant_embark_port3",
                               "infant_disembark_port2",
                               "avg_slave_price_jamaica",
                               "primary_purchase_port",
                               "purchase_location_imputed_region",
                               "purchase_location_imputed_broad_region",
                               "primary_sale_port",
                               "male_embark_port1",
                               "male_died_passage",
                               "male_disembark_port1",
                               "male_embark_port2",
                               "male_embark_port3",
                               "male_disembark_port2",
                               "male_arrival_total",
                               "male_embark_total",
                               "male_death_passage",
                               "male_disembark_total",
                               "pct_male_embark",
                               "pct_male_landed",
                               "pct_male_arrival",
                               "men_embark_port1",
                               "men_died_passage",
                               "men_disembark_port1",
                               "men_embark_port2",
                               "men_embark_port3",
                               "men_disembark_port2",
                               "men_arrival_total",
                               "pct_men_embark",
                               "pct_men_landed",
                               "pct_men_arrival",
                               "purchase_location_imputed_place",
                               "disembark_port_imputed_region",
                               "disembark_port_imputed_broad_region",
                               "disembark_port_imputed_place",
                               "nationality_imputed",
                               "nationality",
                               "slaves_carried_first_port",
                               "slaves_carried_second_port",
                               "slaves_carried_third_port",
                               "crew_deserted_total",
                               "port_before_crossing",
                               "num_ports_before_purchase",
                               "num_ports_americas_before_sale",
                               "primary_owner",
                               "secondary_owner",
                               "tertiary_owner",
                               "fourth_owner",
                               "fifth_owner",
                               "sixth_owner",
                               "seventh_owner",
                               "eighth_owner",
                               "ninth_owner",
                               "tenth_owner",
                               "eleventh_owner",
                               "twelfth_owner",
                               "thirteenth_owner",
                               "fourteenth_owner",
                               "fifteenth_owner",
                               "sixteenth_owner",
                               "primary_purchase_location",
                               "secondary_purchase_location",
                               "tertiary_purchase_location",
                               "construction_place",
                               "registration_place",
                               "departure_port",
                               "return_port",
                               "departure_port_imputed",
                               "primary_disembark_region",
                               "secondary_disembark_region",
                               "disembark_region_1",
                               "disembark_region_2",
                               "disembark_region_3",
                               "embark_region_1",
                               "embark_region_2",
                               "embark_region_3",
                               "registration_region",
                               "african_resistance_outcome_code",
                               "return_region",
                               "return_broad_region",
                               "rig_type",
                               "crew_died_pre_africa",
                               "crew_died_in_africa",
                               "crew_died_middle_passage",
                               "crew_died_americas",
                               "crew_died_return_voyage",
                               "ship_name",
                               "primary_sale_location",
                               "slaves_arrival_first_port",
                               "slave_death_africa",
                               "slave_death_americas",
                               "slave_death_passage",
                               "slaves_disembarked_total",
                               "slaves_disemark_first_port",
                               "slaves_disemark_second_port",
                               "slaves_disemark_third_port",
                               "total_embarked_age",
                               "total_landed_age",
                               "total_arrival_age",
                               "total_embarked_gender",
                               "total_landed_gender",
                               "total_arrival_gender",
                               "total_embarked_slaves",
                               "total_landed_slaves",
                               "total_arrival_slaves",
                               "slaves_embarked_total",
                               "slaves_intented_second_port",
                               "slaves_intented_first_port",
                               "source_a",
                               "source_b",
                               "source_c",
                               "source_d",
                               "source_e",
                               "source_f",
                               "source_g",
                               "source_h",
                               "source_i",
                               "source_j",
                               "source_k",
                               "source_l",
                               "source_m",
                               "source_n",
                               "source_o",
                               "source_p",
                               "source_q",
                               "source_r",
                               "tonnage_imputed",
                               "tonnage",
                               "tonnage_type",
                               "slaves_purchased_total",
                               "slaves_departed_total",
                               "slave_death_total_derived",
                               "voyage_length_home_to_disembarkation_days",
                               "voyage_length_africa_to_disembarkation_days",
                               "middle_passage_length_days",
                               "slave_death_passage_derived",
                               "slave_mortality_rate",
                               "women_embark_port1",
                               "women_died_passage",
                               "women_disembark_port1",
                               "women_embark_port2",
                               "women_embark_port3",
                               "women_disembark_port2",
                               "women_arrival_total",
                               "pct_women_embark",
                               "pct_women_landed",
                               "pct_women_arrival",
                               "voyage_grouping_code",
                               "period_5_year",
                               "period_10_year",
                               "period_25_year",
                               "period_100_year",
                               "departure_from_africa_imputed_year",
                               "landing_imputed_year",
                               "voyage_start_imputed_year",
                               "year_constructed",
                               "registration_year",
                               "voyage_grouping")

### Verify new column names and save; 274 columns, 36108 rows
glimpse(voyages_dataset)
names(voyages_dataset)

### Save the cleaned dataset
write_csv(voyages_dataset, file = "voyages_dataset.csv", na = "")

# ── End of 03_slave_voyages_clean_column_names.R ──